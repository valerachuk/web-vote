<ng-template #deletePollModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title">Warning !!!</h4>
    <button type="button" class="close" (click)="modal.dismiss()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p>
      Do you really want to delete <strong>{{ pollToDelete?.title }}</strong>
    </p>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-outline-danger"
      (click)="modal.close()"
    >
      Yes
    </button>
    <button type="button" class="btn btn-success" (click)="modal.dismiss()">
      No
    </button>
  </div>
</ng-template>

<div *ngIf="pollsInfo$ | async as pollsInfo; else loading">
  <div class="card mb-3" *ngFor="let pollInfo of pollsInfo">
    <div class="card-body">
      <h3>
        <span *ngIf="pollsViewType === PollsViewType.Pending">
          {{ pollInfo.id }})
        </span>
        {{ pollInfo.title }}
      </h3>
      <p class="card-text">{{ pollInfo.description }}</p>
      <p class="card-text text-right">
        Begins at: {{ pollInfo.beginsAt | date: defaultDateTimeFormat }}
        <br />
        Ends at: {{ pollInfo.endsAt | date: defaultDateTimeFormat }}
      </p>
      <hr />
      <ng-template [ngIf]="pollsViewType === PollsViewType.Pending">
        <a
          class="card-link btn btn-warning"
          [routerLink]="['..', 'edit-poll', pollInfo.id]"
          >Edit</a
        >
        <button
          class="card-link btn btn-danger"
          (click)="openDeletePollModal(pollInfo, deletePollModal)"
        >
          Delete
        </button>
      </ng-template>
      <ng-template [ngIf]="pollsViewType === PollsViewType.Active">
        <a
          class="card-link btn btn-primary"
          [routerLink]="['..', 'vote-poll', pollInfo.id]"
          >Vote</a
        >
      </ng-template>
      <ng-template [ngIf]="pollsViewType === PollsViewType.Archive">
        <a
          class="card-link btn btn-primary"
          [routerLink]="['..', 'view-poll', pollInfo.id]"
          >View</a
        >
      </ng-template>
    </div>
  </div>

  <!-- make ngIf from form error instead of array length -->

  <h2 class="text-center" *ngIf="pollsInfo.length === 0">No polls here...</h2>
</div>
<ng-template #loading>
  <app-spinner></app-spinner>
</ng-template>
